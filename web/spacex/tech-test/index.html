<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<div class="heading">
  <input id="key" value="Untitled spreadsheet">
  <button id="load">Load</button>
  <button id="save" title="Call save_data with formula cells intact.">Save</button>
  <button id="export" title="Call save_data with formula cells evaluated.">Export</button>
  <a href="https://github.com/nmlorg/nmlorg.github.io/tree/master/web/spacex/tech-test"
     style="float: right">Code</a>
</div>

<div id="data"></div>

<link rel="stylesheet" href="spreadsheet.css"></script>
<script src="spreadsheet.js"></script>

<script>
var dataElement = document.getElementById('data');
var spreadsheet = new spacex.Spreadsheet(dataElement);
var keyInput = document.getElementById('key');

document.getElementById('load').addEventListener('click', function(e) {
  var data = JSON.parse(load_data(keyInput.value));

  spreadsheet.load(data);
});

document.getElementById('save').addEventListener('click', function(e) {
  var data = spreadsheet.export(true);

  save_data(keyInput.value, JSON.stringify(data));
});

document.getElementById('export').addEventListener('click', function(e) {
  var data = spreadsheet.export();

  save_data(keyInput.value, JSON.stringify(data));
});

if (!window.load_data) {
  load_data = function(key) {
    console.log('Placeholder: Loading', key);
    return JSON.stringify([
        [null, null, 'First row!'],
        [],
        [1, 2, 3, null, '=A3+B3*C3', 'Numbers!'],
    ]);
  }
}

if (!window.save_data) {
  save_data = function(key, value) {
    console.log('Placeholder: Saving', key, value);
    console.log(JSON.parse(value));
  }
}

</script>
